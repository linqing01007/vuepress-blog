大部分逻辑基本与nodejs版本的一致，不同的只是对服务器返回的diff内容的处理逻辑